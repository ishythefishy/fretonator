<ng-template #string let-stringName="stringName" let-string="string">
  <ng-container *ngFor="let fret of frets">
    <div
      class="fretboard__cell"
      [class.fretboard__cell--string]="fret === 0"
      [class.fretboard__cell--selected]="fretMap | getFretFromFretMap: string:fret"
      [attr.data-string-name]="fret === 0 ? stringName : null"
      [attr.data-string]="string"
      [attr.data-fret]="fret"
      [attr.data-degree]="(fretMap | getFretFromFretMap: string : fret)?.degree"
      [attr.data-display-note]="(fretMap | getFretFromFretMap: string : fret)?.displayName"
      [attr.data-mode]="mode"
    ></div>
  </ng-container>
</ng-template>

<div class="arrowHint">
  <span class="arrowHint__arrow"></span>
</div>

<div class="fretboard__container">

  <div data-fretboard class="fretboard">
    <ng-container
      [ngTemplateOutlet]="string"
      [ngTemplateOutletContext]="{ stringName: 'e', string: 'E' }"
    ></ng-container>

    <ng-container
      [ngTemplateOutlet]="string"
      [ngTemplateOutletContext]="{ stringName: 'B', string: 'B' }"
    ></ng-container>

    <ng-container
      [ngTemplateOutlet]="string"
      [ngTemplateOutletContext]="{ stringName: 'G', string: 'G' }"
    ></ng-container>

    <ng-container
      [ngTemplateOutlet]="string"
      [ngTemplateOutletContext]="{ stringName: 'D', string: 'D' }"
    ></ng-container>

    <ng-container
      [ngTemplateOutlet]="string"
      [ngTemplateOutletContext]="{ stringName: 'A', string: 'A' }"
    ></ng-container>

    <ng-container
      [ngTemplateOutlet]="string"
      [ngTemplateOutletContext]="{ stringName: 'E', string: 'E' }"
    ></ng-container>
  </div>
</div>

<div class="infoContainer">

  <div class="infoContainer__row">
    <div class="degrees" *ngIf="mode | displayScaleDegrees">
      <h4 class="degreesDisplay__title">Degrees</h4>
      <div class="degreesDisplay">
        <span class="degreesDisplay__degree degreesDisplay__degree--tonic">1</span>
        <span class="degreesDisplay__degree degreesDisplay__degree--mediant"
        >3</span
        >
        <span class="degreesDisplay__degree degreesDisplay__degree--dominant"
        >5</span>
      </div>
      <button class="scaleDegrees__toggle"
              aria-label="Scale Degrees Info Toggle"
              aria-controls="scaleDegreesInfo"
              role="switch"
              type="button"
              [attr.aria-checked]="showScaleDegreesInfo"
              (click)="toggleScaleDegreesInfo()">{{scaleDegreesToggleText}}
      </button>
    </div>

    <div class="scaleDisplay">
      <h4 class="scaleDisplay__title">Scale</h4>
      <div class="scaleDisplay__notes">
        <ng-container *ngFor="let scaleNote of scale; let i = index">
          <h5 class="scaleDisplay__note">
            {{ scaleNote }}
            <span *ngIf="i < scale.length - 1"> - </span>
          </h5>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="scaleDegreesInfo"
       id="scaleDegreesInfo"
       *ngIf="showScaleDegreesInfo">
    <h2 class="scaleDegreesInfo__title">About Scale Degrees
      <button class="scaleDegreesInfo__close"
              aria-label="Scale Degrees Info Toggle"
              aria-controls="scaleDegreesInfo"
              role="switch"
              type="button"
              (click)="toggleScaleDegreesInfo()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14">
          <path fill="#474350" fill-rule="evenodd"
                d="M14 1.41L12.59 0 7 5.59 1.41 0 0 1.41 5.59 7 0 12.59 1.41 14 7 8.41 12.59 14 14 12.59 8.41 7z"></path>
        </svg>
      </button>
    </h2>
    <p class="scaleDegreesInfo__copy">
      Each of the 7 notes of a mode or scale is called a <em>scale degree</em>, and has a specific name.
    </p>
    <ol class="scaleDegreesInfo__list">
      <li class="scaleDegreesInfo__listItem">Tonic</li>
      <li class="scaleDegreesInfo__listItem">Supertonic</li>
      <li class="scaleDegreesInfo__listItem">Mediant</li>
      <li class="scaleDegreesInfo__listItem">Subdominant</li>
      <li class="scaleDegreesInfo__listItem">Dominant</li>
      <li class="scaleDegreesInfo__listItem">Submediant</li>
      <li class="scaleDegreesInfo__listItem">Leading note</li>
    </ol>
    <p class="scaleDegreesInfo__copy">
      Notes 1, 3 and 5 of a scale make up the <em>tonic triad</em>, which is simply a chord of three notes built on
      the first note of the scale. This is the the most important chord to learn when jamming as it is the <em>home</em>
      chord - meaning it's usually the chord that the jam track starts on and returns to often.
    </p>
    <p class="scaleDegreesInfo__copy">
      Scale degrees 1, 3, and 5 are highlighted on the fretboard to give you a helpful point of reference when learning
      the mode.
    </p>
  </div>

  <div class="intervalDisplay">
    <h4 class="intervalDisplay__title">Mode interval pattern</h4>
    <div class="intervalDisplay__intervals">
      <ng-container *ngFor="let integer of intervalPattern; let i = index">
        <h5 class="intervalDisplay__interval">
          {{ integer | convertIntervalIntegerToString }}
        </h5>
        <span class="intervalDisplay__separator" *ngIf="i < intervalPattern.length - 1"> - </span>
      </ng-container>
    </div>
  </div>

  <div class="chordMap">
    <h4 class="chordMap__title">Chords (triads)</h4>
    <div class="chordMap__chords">
      <ng-container *ngFor="let chord of chordMap; let i = index">
        <h5 class="chordMap__chord">
          {{chord.note}}{{chord.type}}
        </h5>
        <span class="chordMap__separator" *ngIf="i < chordMap.length - 1"> - </span>
      </ng-container>
    </div>
  </div>
</div>
